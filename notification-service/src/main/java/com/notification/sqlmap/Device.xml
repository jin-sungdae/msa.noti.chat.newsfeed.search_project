<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.notification.mapper.DeviceMapper">

    <!-- 디바이스 등록 -->
    <insert id="insertDevice">
        INSERT INTO devices (user_id, device_token, platform, created_at)
        VALUES (#{userId}, #{deviceToken}, #{platform}, NOW())
    </insert>

    <!-- 특정 사용자의 모든 디바이스 가져오기 -->
    <select id="getDevicesByUserId" resultType="com.notification.model.Device">
        SELECT * FROM devices WHERE user_id = #{userId}
    </select>

    <!-- 디바이스 토큰으로 디바이스 찾기 -->
    <select id="getDeviceByToken" resultType="com.notification.model.Device">
        SELECT * FROM devices WHERE device_token = #{deviceToken}
    </select>

    <!-- 특정 사용자의 특정 플랫폼(iOS, Android) 기기 목록 조회 -->
    <select id="getDevicesByUserIdAndPlatform" resultType="com.notification.model.Device">
        SELECT * FROM devices WHERE user_id = #{userId} AND platform = #{platform}
    </select>

    <!-- 특정 사용자의 디바이스 삭제 -->
    <delete id="deleteDeviceByUserIdAndToken">
        DELETE FROM devices WHERE user_id = #{userId} AND device_token = #{deviceToken}
    </delete>


</mapper>